# 開發規格文件編寫規範

> **版本**: 1.0
> **更新日期**: 2025-11-20
> **用途**: 定義開發規格文件的組織架構、編寫規範和維護流程

---

## 📚 文件組織架構

### 文件分層

本專案採用**「主索引 + 詳細文件」**的兩層架構：

```
docs/
├── WORK_LOG.md                     # 工作日誌主頁
├── spec_model.md                   # 模型規格（主索引）
├── spec_web.md                     # 網站業務邏輯規格（主索引）
├── spec_web_api.md                 # API 規格（主索引）
├── spec_guidelines.md              # 本文件：編寫規範
│
├── model/                          # 模型詳細文件資料夾
│   ├── data_資料處理流程.md
│   ├── data_資料欄位定義.md
│   ├── data_資料處理規則.md
│   ├── ml_特徵工程.md
│   ├── data_資料過濾工具.md
│   ├── ml_模型優化路線圖.md
│   └── ml_特徵配置.yaml
│
├── web/                            # 網站詳細文件資料夾
│   ├── web_網站架構說明.md
│   └── web_預處理資料下載指南.md
│
├── shared/                         # 共用文件資料夾
│   ├── pipeline_配置使用說明.md
│   └── pipeline_修改指南.md
│
└── work_log/                       # 工作日誌資料夾
    ├── WORK_LOG_票房預測模型優化流程.md
    ├── WORK_LOG_模型優化進度.md
    └── WORK_LOG_模型評估與模型產出_20251119.md
```

### 層級定義

#### 第一層：主索引文件（spec_*.md）
- **定位**: 供開發者快速了解系統概要的入口文件
- **內容**:
  - 系統概述（目標、架構、關鍵概念）
  - 各模組的簡要說明
  - 重要流程的高階描述
  - 詳細文件的索引連結
- **長度限制**: 建議不超過 800 行（過長時考慮拆分）
- **更新頻率**: 架構變更時必須更新

#### 第二層：詳細文件（model/*.md, web/*.md）
- **定位**: 深入的技術細節說明
- **內容**:
  - 詳細的實作邏輯
  - 完整的範例和圖表
  - 計算公式和演算法
  - 特殊情況處理
- **長度限制**: 無限制，依需要撰寫
- **更新頻率**: 實作變更時必須更新

---

## ✍️ 編寫規範

### 主索引文件（spec_*.md）格式

```markdown
# [系統名稱] 規格文件

> **版本**: 1.x
> **更新日期**: YYYY-MM-DD
> **簡介**: 一句話描述文件用途

---

## 📋 目錄

[自動生成或手動維護的目錄]

---

## 系統概述

### 目標
- 清楚說明系統要解決的問題
- 列出主要功能

### 核心概念
- 定義關鍵術語
- 說明重要概念

---

## 模組 A

### 概要
簡要說明模組 A 的功能和責任

### 關鍵流程
高階流程圖或步驟說明

### 詳細文件
- [詳細文件 A1](./子資料夾/文件.md)
- [詳細文件 A2](./子資料夾/文件.md)

---

## 模組 B

[同上格式]

---

## 相關文件索引

### 模型相關
- [Pipeline 流程](./model/data_資料處理流程.md)
- [資料欄位定義](./model/data_資料欄位定義.md)

### 網站相關
- [架構說明](./web/web_網站架構說明.md)

### 共用文件
- [Pipeline 配置使用](./shared/pipeline_配置使用說明.md)
```

### 詳細文件格式

```markdown
# [主題名稱]

> **版本**: 1.x
> **更新日期**: YYYY-MM-DD
> **用途**: 詳細說明

**主索引**: [返回 XXX 規格文件](../spec_xxx.md)

---

## 目錄

[詳細目錄]

---

## 詳細內容

[依主題組織的詳細內容]

### 範例
提供實際範例和程式碼片段

### 注意事項
列出重要的注意事項

---

## 相關文件
- [相關文件 1](./xxx.md)
- [相關文件 2](./xxx.md)
```

---

## 🔗 文件連結規範

### 內部連結

- **相對路徑**: 使用相對路徑引用同一 docs 內的文件
  ```markdown
  [Pipeline 流程](./model/data_資料處理流程.md)
  [返回主索引](../spec_model.md)
  ```

- **錨點連結**: 引用同一文件內的章節
  ```markdown
  [詳見資料處理規則](#資料處理規則)
  ```

### 雙向連結

- 主索引必須連結到詳細文件
- 詳細文件必須連結回主索引
- 相關文件之間應建立橫向連結

### 失效連結

- 移動或刪除文件時，必須更新所有引用該文件的連結
- 建議使用 IDE 的重構功能或搜尋工具檢查

---

## 📝 內容撰寫規範

### 標題層級

```markdown
# H1：文件標題（每個文件只有一個）

## H2：主要章節

### H3：次要章節

#### H4：細節說明

##### H5、H6：避免使用（層級過深）
```

### 程式碼區塊

- **語言標記**: 必須指定語言（python, javascript, bash, sql 等）
  ```markdown
  ```python
  def example():
      pass
  ```​
  ```

- **檔案路徑**: 在程式碼上方標註檔案路徑
  ```markdown
  **檔案**: `src/web/app.py`
  ```python
  app = Flask(__name__)
  ```​
  ```

### 表格

- 使用 Markdown 表格格式
- 複雜表格考慮使用 HTML
- 必須包含表頭

```markdown
| 欄位名稱 | 類型 | 說明 |
|---------|------|------|
| id      | int  | 識別碼 |
```

### 引用和提示

使用 blockquote 標記重要資訊：

```markdown
> **重要**: 關鍵注意事項

> **提示**: 建議和最佳實踐

> ⚠️ **警告**: 可能的錯誤或陷阱

> 🔄 **未來改進**: 待實作的功能
```

### 清單

- **無序清單**: 用於並列項目
  ```markdown
  - 項目 1
  - 項目 2
  ```

- **有序清單**: 用於步驟或優先順序
  ```markdown
  1. 步驟 1
  2. 步驟 2
  ```

- **勾選清單**: 用於檢查清單
  ```markdown
  - [ ] 待辦事項
  - [x] 已完成事項
  ```

---

## 🔄 維護流程

### 何時更新文件

#### 必須更新（Blocking）
以下情況必須在程式碼提交前更新文件：

- ✅ 新增或移除模組/功能
- ✅ 修改 API 介面（端點、參數、回應格式）
- ✅ 變更資料結構或資料庫 schema
- ✅ 修改核心演算法或計算邏輯
- ✅ 變更配置檔案格式

#### 建議更新（Non-blocking）
以下情況建議儘快更新文件：

- 📝 優化現有功能的實作細節
- 📝 修正 bug（如果影響理解）
- 📝 新增範例或最佳實踐

#### 不需要更新
以下情況不需要更新規格文件：

- ❌ 程式碼重構（不改變外部行為）
- ❌ 效能優化（不改變邏輯）
- ❌ 程式碼註解修改
- ❌ 測試程式碼變更

### 版本號規則

使用語意化版本號（Semantic Versioning）：

- **主版號（Major）**: 架構重大變更、不相容的 API 變更
  - 範例：`1.0` → `2.0`

- **次版號（Minor）**: 新增功能、相容的 API 擴充
  - 範例：`1.0` → `1.1`

- **修訂號（Patch）**: 錯誤修正、文字修改
  - 範例：`1.1` → `1.1.1`（可選，規格文件通常省略）

### 更新日期格式

統一使用 ISO 8601 格式：`YYYY-MM-DD`

```markdown
> **版本**: 1.2
> **更新日期**: 2025-11-20
```

### 變更日誌

在文件末尾維護變更日誌（選用）：

```markdown
---

## 變更日誌

### v1.2 (2025-11-20)
- 新增：XXX 功能說明
- 修改：YYY 流程描述
- 移除：ZZZ 過時內容

### v1.1 (2025-11-15)
- 新增：ABC 模組說明

### v1.0 (2025-11-01)
- 初始版本
```

---

## 🎯 文件品質檢查清單

### 完整性檢查

- [ ] 文件標題、版本、更新日期完整
- [ ] 目錄結構清晰、連結有效
- [ ] 所有模組/功能都有說明
- [ ] 重要概念都有定義
- [ ] 範例程式碼可執行

### 一致性檢查

- [ ] 術語使用一致（建立術語表）
- [ ] 格式符合規範（標題、程式碼、表格）
- [ ] 檔案命名符合規範
- [ ] 連結路徑正確

### 可讀性檢查

- [ ] 段落長度適中（避免超過 10 行）
- [ ] 使用清晰的標題和子標題
- [ ] 重要資訊使用 blockquote 突顯
- [ ] 複雜邏輯提供圖表或流程圖
- [ ] 專業術語有解釋或範例

---

## 📖 術語表

| 術語 | 英文 | 定義 |
|-----|------|------|
| 主索引 | Main Index | 規格文件的入口，提供系統概要和文件導航 |
| 詳細文件 | Detailed Documentation | 深入說明特定主題的技術文件 |
| 輪次 | Round | 電影的上映輪次（首輪、次輪等） |
| 週次 | Week | 電影上映後的週數 |
| Pipeline | Pipeline | 資料處理流程 |
| 特徵工程 | Feature Engineering | 從原始資料提取和構建模型特徵的過程 |

---

## 🛠️ 工具和輔助

### 推薦工具

- **Markdown 編輯器**: VS Code + Markdown All in One 擴充
- **目錄生成**: Markdown TOC 擴充（自動生成目錄）
- **連結檢查**: Markdown Link Check 工具
- **圖表繪製**: Mermaid（流程圖、序列圖）

### Mermaid 流程圖範例

```markdown
​```mermaid
graph TD
    A[開始] --> B{判斷條件}
    B -->|是| C[處理 A]
    B -->|否| D[處理 B]
    C --> E[結束]
    D --> E
​```
```

---

## 📞 聯絡與回饋

如果對文件規範有疑問或建議，請：

1. 提交 Issue 到專案 GitHub
2. 聯絡專案負責人
3. 在團隊會議中討論

---

**本規範本身也會隨專案演進而更新，歡迎提出改進建議！**
